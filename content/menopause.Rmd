---
title: "Menopause"
output: html_document
---

```{r setup, include = FALSE}
# include = FALSE: Neither code nor output shown
# echo = FALSE: Only output shown

# Suppress all output by default
knitr::opts_chunk$set(echo = FALSE)

# Load required packages
library(ggplot2)
library(gganimate)

# Theme setup
my_theme <- theme_classic() + theme(plot.background = element_rect(NULL), panel.grid = element_line(NULL))
```

```{r read.data}
# Read in txt file
bcsc <- read.delim("Data/bcsc/risk.txt", header = FALSE, sep = "")

# Assign names to variables in the BCSC header
names(bcsc) <- c("menopaus", "agegrp", "density", "race", "hispanic", "bmi", "agefirst", "nrelbc", "brstproc", "lastmamm", "surgmeno", "hrt", "invasive", "cancer", "training", "count")
```

```{r plot}
# Create subset of BCSC data with only positive diagnoses and wihtout unknown menopause data ("9" in the dataset)
cancer.bcsc <- subset(bcsc, cancer == "1" & menopaus <= 2)

# Give labels to the menopaus factor (categorical variable)
menopaus.factor <- factor(cancer.bcsc$menopaus, labels = c("Premenopausal", "Postmenopausual"))

# Plot
plot <- ggplot(cancer.bcsc, aes(x = menopaus.factor)) + 
  geom_bar(fill = "pink", colour = "black") + 
  my_theme +
  labs(title = "Effect of Menopause on the Incidence of Breast Cancer", x = "", y = "Frequency of Breast Cancer") +
  ## gganimate specific code
  transition_states(menopaus.factor, transition_length = 1, state_length = 1, wrap = FALSE) + 
  enter_fade() + enter_grow() +
  shadow_mark() +
  ease_aes('quadratic-in-out')
animate(plot, nframes = 60, fps=30, renderer = gifski_renderer(loop = FALSE))
```

```{r testing, include = FALSE}
# To see output, set include = TRUE

# One-way ANOVA
anova <- aov(agegrp ~ menopaus, data = bcsc)
summary(anova)
```

The bar plot shows the number of women who were diagnosed with breast cancer within 1 year and whether they were premenopausal or postmenopausal. As 70% of all breast cancer types are oestrogen receptor positive cancers, starting menopause further increases a woman’s risk of developing breast cancer as the more menstrual periods a woman has, the longer their body is exposed to high levels of oestrogen.[^6]

[^6]: Sweeney, C. 2004, ‘Risk Factors for Breast Cancer in Elderly Women’, *American Journal of Epidemiology*, vol. 160, no. 9, pp. 868-75.